@model EduApi.SiteModels.UyeMesajlarModel
@{
    ViewBag.Title = Resources.Varsayilan.baslik_mesajlar;
}
<div id="mesajtabs" class="clearfix" style="margin-left: 15px;margin-right: 15px;">
    <input type="hidden" value="@(ViewBag.acilacak==null? "mesajlitab":ViewBag.acilacak)" id="UyeMesajTabName" />
    <div id="mesajayarlari" class="clearfix col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div id="mesajayarlari" class="clearfix col-lg-12 col-md-12 col-sm-12 col-xs-12" style="margin-top: 50px;">
            <div id="silmehata" class="col-xs-12 paddingsagsol0" style="display: none;">
                <div class="alert alert-danger">
                    <a style="font-size:33px" class="pull-right" href="#" onclick="gorunmezyap(event, silmehata)">&times;</a>
                    <i class="icon-gift"></i><strong>@Resources.Varsayilan.u_bildirimsilmehata ..</strong>
                </div>
            </div>
            <div id="onaylahata" class="col-xs-12 paddingsagsol0" style="display: none;">
                <div class="alert alert-danger">
                    <a style="font-size:33px" class="pull-right" href="#" onclick="gorunmezyap(event, onaylahata)">&times;</a>
                    <i class="icon-gift"></i><strong>@Resources.Varsayilan.u_bildirimkayithata ..</strong>
                </div>
            </div>
            <div id="silmebasarili" class="col-xs-12 paddingsagsol0" style="display: none;">
                <div class="alert alert-success">
                    <a style="font-size:33px" class="pull-right" href="#" onclick="gorunmezyap(event, silmebasarili)">&times;</a>
                    <i class="icon-gift"></i><strong>@Resources.Varsayilan.u_bildirimsilindi ..</strong>
                </div>
            </div>
            <div id="Tabs" style="padding: 0">
                <ul id="tabsayarla" class="nav nav-pills nav-stacked col-sm-2 col-xs-12">
                    <div Class="tabscss">
                        <li class="active col-lg-12 aktifrenk" id="mesajlitab">
                            <a href="#mesajlitab_icerik" onclick="MesajlitabClick(event)" data-toggle="pill" style="text-align: center !important; font-weight: bold;">
                                @Resources.Varsayilan.b_edusor
                                <span class="pull-right" id="okunmayan_mesaj_sayisi">@(Model.mesajlar.Where(x => x.okundu == 0 && x.uye_id == 0 && x.turu == 0).ToList().Count > 0 ? "(" + Model.mesajlar.Where(x => x.okundu == 0 && x.uye_id == 0 && x.turu == 0).ToList().Count + ")" : "")</span>
                            </a>
                        </li>
                    </div>
                    @if (Model.kampanyalar.Count > 0)
                    {
                        <li style="background-color: #a02f89 !important; color: white; margin-top: 5px !important; margin-bottom: 5px !important;" id="edukampanyabaslik">@Resources.Varsayilan.baslik_kampanyabildirimi</li>
                        <div class="tabscss" style="max-height: 320px;overflow:auto;" id="kampanyabilidirimlist">
                            @for (int i = 0; i < Model.kampanyalar.Count; i++)
                            {
                                <li class="col-lg-12 aktifrenk" id="tabs_@Model.kampanyalar[i].toplu_mesaj.id">
                                    <a href="@("#tabs_" + Model.kampanyalar[i].toplu_mesaj.id + "_icerik")" onclick="MesajlitabClick(event)" data-toggle="pill">@Model.kampanyalar[i].toplu_mesaj.baslik</a>
                                </li>
                            }
                        </div>
                    }
                    @if (Model.bildirimler.Count > 0)
                    {
                        <li style="background-color: #a02f89 !important; color: white; margin-top: 5px !important; margin-bottom: 5px !important;" id="edubildi">@Resources.Varsayilan.baslik_edubild</li>
                        <div class="tabscss" style="overflow:auto;" id="edubildirimlist">
                            @for (int i = 0; i < Model.bildirimler.Count; i++)
                            {
                                <li class="col-lg-12 aktifrenk" id="tabs_@Model.bildirimler[i].id">
                                    <a href="@("#tabs_" + Model.bildirimler[i].id + "_icerik")" onclick="MesajlitabClick(event)" data-toggle="pill">@Model.bildirimler[i].baslik</a>
                                </li>
                            }
                        </div>
                    }
                </ul>
            </div>
            <div id="tabsicerikayarla" class="tab-content col-sm-10 col-xs-12" style="padding: 0;margin-bottom: 20px;">
                <div class="form-process" id="mesaj_load"></div>
                <div class="tab-pane active" ID="mesajlitab_icerik" style="margin-left: 36px; margin: 0;">
                    <div class="mesajbaslik">
                        <div align="center">
                            <img src="/Content/images/logoyan.png" style="height: 55px;" class="img-responsive" alt="EduAdvisor Logo" />
                        </div>
                    </div>
                    <div id="mesaj_panel" class="mesaj_icerik col-xs-12" style="height:430px;overflow:auto;">
                        @{
                            List<string> gunler = new List<string>();
                            for (int i = 0; i < Model.mesajlar.Count; i++)
                            {
                                if (!gunler.Contains(Model.mesajlar[i].tarih.ToString("dd.MM.yyyy")))
                                {
                                    <div ID="gun" Class="mesajtarih">
                                        <span id="gun_tarihi">@Model.mesajlar[i].tarih.ToString("dd.MM.yyyy")</span>
                                    </div>
                                    gunler.Add(Model.mesajlar[i].tarih.ToString("dd.MM.yyyy"));
                                }
                                <div class="row">
                                    <div class="@(Model.mesajlar[i].uye_id==0 ? "mesajgelen pull-left":"mesajgonderen pull-right")">
                                        @Model.mesajlar[i].icerik
                                        <div class="mesajsaati pull-right">
                                            <label>@Model.mesajlar[i].tarih.ToString("HH:mm")</label>
                                        </div>
                                    </div>
                                </div>
                            }
                        }
                    </div>
                    <div class="col-xs-12" style="width: 100%; padding: 0; margin: 0;">
                        <div class="col-xs-10" style="padding: 0">
                            <div class="input-group" style="min-height: 40px; width: 100%;">
                                <input id="mesajicerik" type="text" class="form-control" style="height: 40px; border-radius: 11px;" placeholder="@Resources.Varsayilan.bi_mesajyaz" />
                                <label class="arama-tur-secilmedi mesajicerikerror"><i class="glyphicon glyphicon-triangle-top"></i>@Resources.Varsayilan.b_mesajgiriniz</label>
                            </div>
                        </div>
                        <div class="col-xs-2" style="padding: 0">
                            <div class="input-group" style="min-height: 40px; width: 100%; text-align: center;">
                                <a id="mesajGonder" class="button button-small button-circle button-green" onclick="UyeProfilMesajGonder(event)">
                                    <span class="yaziyoket">@Resources.Varsayilan.b_gonder</span>
                                    <i class="glyphicon glyphicon-send iconyoket"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div id="mesajhata" class="col-xs-8" style="display: none;">
                        <div class="alert alert-danger">
                            <a style="font-size:33px" class="pull-right" href="#" onclick="gorunmezyap(event, mesajhata)">&times;</a>
                            <i class="icon-gift"></i><strong>@Resources.Varsayilan.u_mesajsorun ..</strong>
                        </div>
                    </div>
                </div>
                @for (int i = 0; i < Model.kampanyalar.Count; i++)
                {
                    <div class="tab-pane" id="@("tabs_" + Model.kampanyalar[i].toplu_mesaj.id + "_icerik")" style="margin-left: 36px; min-height: 600px">
                        @if (Model.kampanyalar[i].toplu_mesaj.okul_id != -1)
                        {
                            <div id="indirimbildirimi">
                                <img src="~/Content/images/kuponlar/@((HttpContext.Current.Session["Dil"].ToString() =="tr-TR" ? "tr/":"en/")+ Model.kampanyalar[i].okullar.okul_indirimleri.FirstOrDefault().orani+"-01.png")" id="kupon1" alt="EduAdvisor @Resources.Varsayilan.baslik_kampanyabildirimi" />                              
                                <a href="@Url.RouteUrl("OkulDetay", new { GrupSeo = Model.kampanyalar[i].okullar.okul_grup_iliski.FirstOrDefault().okul_gruplari.seo_url, OkulSeo = Model.kampanyalar[i].okullar.seo_url })">
                                    <img src="/Content/img/okul/@Model.kampanyalar[i].okullar.logo" class="img-responsive marginright10" style="float: left !important;" alt="@Model.kampanyalar[i].okullar.adi">
                                </a>
                            </div>
                            <h5>
                                <a href="@(Url.RouteUrl("OkulDetay", new { GrupSeo = Model.kampanyalar[i].okullar.okul_grup_iliski.FirstOrDefault().okul_gruplari.seo_url, OkulSeo = Model.kampanyalar[i].okullar.seo_url }))" class="baslik_bildirim">
                                    @(Model.kampanyalar[i].okullar.okul_grup_iliski.FirstOrDefault().okul_gruplari.adi + " - " + @Model.kampanyalar[i].okullar.adi)
                                </a>
                            </h5>

                            <p class="marginbottom0 okulbildirim_icerik">@Model.kampanyalar[i].toplu_mesaj.icerik</p>

                            <div id="detaylilink" Class="col-md-6 paddingsagsol0 paddingtop20">
                                <a href="@(Url.RouteUrl("OkulDetay", new { GrupSeo = Model.kampanyalar[i].okullar.okul_grup_iliski.FirstOrDefault().okul_gruplari.seo_url, OkulSeo = Model.kampanyalar[i].okullar.seo_url }))" class="baslik_bildirim" style="width: 50%">@Resources.Varsayilan.b_okuldetaylitikla</a>
                            </div>

                            <div class="col-md-12 paddingsagsol0 paddingtop40">
                                @if (Model.kampanyalar[i].toplu_mesaj.indirim_uye.Where(x => x.uyeler.mail == HttpContext.Current.Session["giris_yapan"].ToString()).ToList().Count == 0)
                                {
                                    <div id="@("tabs_" + Model.kampanyalar[i].toplu_mesaj.id + "_icerik_islemler")">
                                        <div id="ilgilenmiyorumpanel" class="col-md-6 paddingsol10">
                                            <a id="ilgilenmiyorum" Style="width: 50%; float: right !important;" class="detaylibigisag btn btn-danger bgcolor border-color"
                                               onclick="BildirimSil(event,@Model.kampanyalar[i].toplu_mesaj.id,'@Resources.Varsayilan.bu_bildirim_sil_onay',@("tabs_" + Model.kampanyalar[i].toplu_mesaj.id))">
                                                @Resources.Varsayilan.b_ilgilenmiyorum
                                            </a>
                                        </div>
                                        <div id="ilgileniyorumpanel" class="col-md-6  paddingsol10">
                                            <a id="ilgileniyorum" class="detaylibigisag btn btn-danger bgcolor border-color" onclick="BildirimOnayla(event,@Model.kampanyalar[i].toplu_mesaj.id,'@Resources.Varsayilan.uye_profil_bildirim_onayla_onay')">
                                                @Resources.Varsayilan.b_ilgili
                                            </a>
                                        </div>
                                    </div>
                                }
                                <div id="@("tabs_" + Model.kampanyalar[i].toplu_mesaj.id + "_icerik_tesekkur_alani")" style="display:@(Model.kampanyalar[i].toplu_mesaj.indirim_uye.Where(x => x.uyeler.mail == HttpContext.Current.Session["giris_yapan"].ToString() && x.durumu > 0).ToList().Count > 0 ? "block":"none")">
                                    <div class="col-md-12 onkayitmesaj paddingsagsol0">
                                        <a href="@(Url.RouteUrl("OnKayitForm", new { GrupSeo = Model.kampanyalar[i].okullar.okul_grup_iliski.FirstOrDefault().okul_gruplari.seo_url, OkulSeo = Model.kampanyalar[i].okullar.seo_url }))">
                                            <h5 style="color: white" class="marginleft15">@Resources.Varsayilan.b_onkayittikla</h5>
                                        </a>
                                    </div>
                                    <div class="successmsg onkayitmesaj" style="border-left: 9px solid #613f5a;">
                                        <div class="msgtitle marginleft15">
                                            @Resources.Varsayilan.u_talepiletildi
                                            <br />
                                            @Resources.Varsayilan.b_tesekkur
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                }
                @for (int i = 0; i < Model.bildirimler.Count; i++)
                {
                    <div class="tab-pane" id="@("tabs_" + Model.bildirimler[i].id + "_icerik")" style="margin-left: 36px; min-height: 600px">
                        <h3 style="font-family: 'eduFont'; color: #a02f89; padding-top: 0px;">@Model.bildirimler[i].baslik</h3>
                        <p class="marginbottom0">@Model.bildirimler[i].icerik</p>
                        <div class="col-md-12 paddingsagsol0 paddingtop40">
                            @if (Model.bildirimler[i].okul_id == -1)
                            {
                                <div ID="bildirisil" class="col-md-6 paddingsagsol0 margintop35">
                                    <a id="bildirisilme" class="detaylibigisag btn btn-danger bgcolor border-color" style="width: 30%;" onclick="BildirimSil(event,@Model.bildirimler[i].id,'@Resources.Varsayilan.bu_bildirim_sil_onay',@("tabs_" + Model.bildirimler[i].id))">
                                        @Resources.Varsayilan.b_bildirimsl
                                    </a>
                                </div>
                            }
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>
